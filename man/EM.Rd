% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HMRF.R
\name{EM}
\alias{EM}
\title{Expectation-Maximization (EM) Algorithm for HMRF-ICM}
\usage{
EM(
  X_j,
  N_j,
  pi_j0 = 0.1,
  gamma = 0.5,
  pi_1j = 0.5,
  iterations = 10,
  stop_diff = 1e-05,
  neighbor_s_list,
  neighbor_s_vaf,
  Wc,
  neighbor_num = 4,
  icm_iter = 10,
  prior_energy = F,
  save_path = NULL,
  verbose = T
)
}
\arguments{
\item{X_j}{Numeric vector of observed variant allele counts.}

\item{N_j}{Numeric vector of total read counts.}

\item{pi_j0}{Initial probability of background signals.}

\item{gamma}{Initial gamma parameter, representing contamination rate.}

\item{pi_1j}{Initial probability of carrier.}

\item{iterations}{Maximum number of EM iterations.}

\item{stop_diff}{Convergence threshold; the algorithm stops if the parameter change is below this.}

\item{neighbor_s_list}{List of nearest neighbor indices for each spot.}

\item{neighbor_s_vaf}{Numeric vector of neighborhood variant allele frequencies.}

\item{Wc}{Numeric vector representing weighted cell-type proportions from tools like RCTD.}

\item{prior_energy}{Logical; whether to include prior energy function in calculations.}

\item{save_path}{Optional directory path to save model results.}

\item{verbose}{Logical; whether to print progress messages.}
}
\value{
A list containing estimated parameter trajectories and final Z_j assignments.
\describe{
\item{pi_j0_list}{Vector of estimated pi_j0 values across iterations.}
\item{gamma_list}{Vector of estimated gamma values across iterations.}
\item{pi_1j_list}{Vector of estimated pi_1j values across iterations.}
\item{LPP_list}{Vector of log posterior probabilities across iterations.}
\item{Z_j}{Final estimated latent variable assignments.}
}
}
\description{
This function performs the EM algorithm to estimate model parameters and
assign latent variables (Z_j) using an Iterated Conditional Modes (ICM) approach.
}
