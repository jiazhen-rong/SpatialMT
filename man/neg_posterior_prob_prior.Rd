% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HMRF.R
\name{neg_posterior_prob_prior}
\alias{neg_posterior_prob_prior}
\title{Compute Negative Log Posterior Probability (With Prior Energy)}
\usage{
neg_posterior_prob_prior(param, data, neighbor_num = 4)
}
\arguments{
\item{param}{Numeric vector containing the model parameters:
\describe{
\item{\code{param[1]}}{Initial probability of background \eqn{\pi_{j0}}.}
\item{\code{param[2]}}{Neighborhood effect scaling parameter \eqn{\gamma}.}
\item{\code{param[3]}}{Probability of carrier identity \eqn{\pi_{1j}}.}
}}

\item{data}{A list containing the following elements:
\describe{
\item{\code{X_j}}{Numeric vector of observed variant allele counts.}
\item{\code{N_j}}{Numeric vector of total read counts.}
\item{\code{Z_j}}{Numeric vector of latent variable assignments (0 = background, 1 = carrier).}
\item{\code{neighbor_s_vaf}}{Numeric vector of neighborhood variant allele frequencies.}
\item{\code{Wc}}{Numeric vector of weighted cell-type proportions at each location.}
\item{\code{neighbor_s_list}}{List where each element contains the indices of neighboring spots.}
}}

\item{neighbor_num}{Integer specifying the number of neighbors to consider for each spot.}
}
\value{
The negative log posterior probability (a scalar value).
}
\description{
This function calculates the negative log posterior probability while incorporating
a spatial prior energy function to encourage spatial smoothness in the HMRF model.
}
\details{
This function computes:
\deqn{NPP = - \sum \left[ \log P(X_j | Z_j, \pi_{j0}, \gamma, \pi_{1j}) + \log P(Z_j | \text{neighbors}) \right]}
where:
\itemize{
\item \eqn{P(X_j | Z_j)} is modeled using the binomial likelihood.
\item \eqn{P(Z_j | \text{neighbors})} is a spatial prior energy function that encourages smoothness.
}

The function is used for parameter estimation during the M-step in the EM algorithm with prior energy.
}
\examples{
# Define parameter values
params <- c(0.1, 0.5, 0.5)

# Define input data
data_list <- list(
  X_j = c(10, 5, 8),
  N_j = c(100, 50, 80),
  Z_j = c(0, 1, 0),
  neighbor_s_vaf = c(0.1, 0.05, 0.08),
  Wc = c(0.2, 0.1, 0.3),
  neighbor_s_list = list(c(2,3), c(1,3), c(1,2))
)

# Compute negative log posterior probability with prior energy
neg_log_posterior <- neg_posterior_prob_prior(params, data_list, neighbor_num = 4)
print(neg_log_posterior)
}
