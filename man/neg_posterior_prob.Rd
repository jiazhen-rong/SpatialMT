% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HMRF.R
\name{neg_posterior_prob}
\alias{neg_posterior_prob}
\title{Compute Negative Log Posterior Probability (Without Prior Energy)}
\usage{
neg_posterior_prob(param, data)
}
\arguments{
\item{param}{Numeric vector containing the model parameters:
\describe{
\item{\code{param[1]}}{Initial probability of background \eqn{\pi_{j0}}.}
\item{\code{param[2]}}{Neighborhood effect scaling parameter \eqn{\gamma}.}
\item{\code{param[3]}}{Probability of carrier identity \eqn{\pi_{1j}}.}
}}

\item{data}{A list containing the following elements:
\describe{
\item{\code{X_j}}{Numeric vector of observed variant allele counts.}
\item{\code{N_j}}{Numeric vector of total read counts.}
\item{\code{Z_j}}{Numeric vector of latent variable assignments (0 = background, 1 = carrier).}
\item{\code{neighbor_s_vaf}}{Numeric vector of neighborhood variant allele frequencies.}
\item{\code{Wc}}{Numeric vector of weighted cell-type proportions at each location.}
}}
}
\value{
The negative log posterior probability (a scalar value).
}
\description{
This function calculates the negative log posterior probability for a given set of parameters
without incorporating a spatial prior energy function. It is used in the M-step of the EM algorithm
for optimizing \eqn{\pi_{j0}}, \eqn{\gamma}, and \eqn{\pi_{1j}}.
}
\details{
This function computes:
\deqn{NPP = - \sum \log P(X_j | Z_j, \pi_{j0}, \gamma, \pi_{1j})}
where \eqn{P(X_j | Z_j)} is modeled using the binomial likelihood.
The function is used for parameter estimation during the M-step in the EM algorithm.
}
\examples{
# Define parameter values
params <- c(0.1, 0.5, 0.5)

# Define input data
data_list <- list(
  X_j = c(10, 5, 8),
  N_j = c(100, 50, 80),
  Z_j = c(0, 1, 0),
  neighbor_s_vaf = c(0.1, 0.05, 0.08),
  Wc = c(0.2, 0.1, 0.3)
)

# Compute negative log posterior probability
neg_log_posterior <- neg_posterior_prob(params, data_list)
print(neg_log_posterior)
}
