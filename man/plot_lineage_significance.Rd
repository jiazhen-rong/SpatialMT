% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Visualization.R
\name{plot_lineage_significance}
\alias{plot_lineage_significance}
\title{Plot variant-by-celltype significance as grouped bars}
\usage{
plot_lineage_significance(
  res,
  celltypes = NULL,
  keep_positive_only = TRUE,
  order_by = NULL,
  p_threshold = 0.05,
  logy = TRUE,
  zero_floor = 0.01,
  fill_values = NULL,
  base_size = 13,
  width = 10,
  height = 5,
  outfile = NULL,
  draw_axis_break = TRUE,
  return_plot = T,
  title = NULL
)
}
\arguments{
\item{res}{A result list from the \code{celltype_test()} function:
\itemize{
\item \code{adjusted_pval}: matrix/data.frame of p-values (variants x celltypes)
\item \code{coef}: matrix/data.frame of coefficients (variants x celltypes) used to optionally mask negatives
}}

\item{celltypes}{Character vector of celltypes to plot. If \code{NULL}, plot all.}

\item{keep_positive_only}{Logical; if TRUE (default), any entries with coef < 0 have p set to 1 (logp=0).}

\item{order_by}{Celltype name used to order variants (descending -log10(p) in that celltype).
If NULL, variants keep their original order.}

\item{p_threshold}{Numeric p-value threshold line (default 0.05).}

\item{logy}{Logical; if TRUE, use log10 y-scale with special handling of zeros (default TRUE).}

\item{zero_floor}{Numeric; when \code{logy=TRUE}, values with logp==0 are plotted at this floor (default 1e-2).}

\item{fill_values}{Optional named vector of colors for celltypes (names must match celltypes).
If NULL, ggplot default palette is used.}

\item{base_size}{Base font size for theme_minimal (default 13).}

\item{width, height}{PDF width/height if saving.}

\item{outfile}{If provided, save a PDF to this path. If NULL, no file is saved.}

\item{draw_axis_break}{Logical; if TRUE and \code{logy=TRUE}, draw a small '//' mark to indicate axis break.}
}
\value{
A ggplot object
}
\description{
Creates a grouped bar plot of -log10(p) per (Variant, Celltype), using
adjusted p-values from SpatialMT celltype association results.
}
\details{
By default, all celltypes present in \code{res$adjusted_pval} are plotted.
If \code{celltypes} is provided, only those columns are plotted.
}
