% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HMRF.R
\name{prior_energy_U}
\alias{prior_energy_U}
\title{Compute Prior Energy Function for HMRF Model}
\usage{
prior_energy_U(neighbor_num = 4, neighbor_spots, Z_j, Z)
}
\arguments{
\item{neighbor_spots}{Numeric vector of indices representing neighboring spots.}

\item{Z_j}{Numeric vector of latent variable assignments for all spots (0 = background, 1 = carrier).}

\item{Z}{Scalar (0 or 1), the latent state being considered for the given spot s.}
}
\value{
The prior energy probability value.
}
\description{
This function calculates the spatial prior probability \eqn{P(Z_j | \text{neighbors})}
given the latent variable \eqn{Z_j} and its neighboring spots.
}
\details{
The function computes:
\deqn{U_x = \frac{1}{(2\pi)^{n/2}} \exp(- V_c)}
where:
\itemize{
\item \eqn{V_c} is the sum of pairwise neighbor mismatches.
\item \eqn{n} is the number of neighbors.
}

If no neighbors are present, the function returns 1 (neutral effect).
}
\examples{
Z_j <- c(0, 1, 1, 0, 1)
neighbor_spots <- c(2, 3, 5)
prior_energy_U(neighbor_spots, Z_j, Z = 1)
}
