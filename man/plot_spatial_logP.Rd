% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/carrier_celltype_determination.R
\name{plot_spatial_logP}
\alias{plot_spatial_logP}
\title{Plot Spatial Distribution of Adjusted P-values on a Signed -log10 Scale}
\usage{
plot_spatial_logP(
  results,
  var,
  p_thresh = 0.05,
  max_log10p_cap = 6,
  coef_plot_option = "negative"
)
}
\arguments{
\item{results}{A list returned from a grid-based celltype test. Each element (grid)
should contain matrices \code{adjusted_pval} and \code{coef} with row names as variant IDs
and column names as cell types.}
}
\value{
A \code{ggplot2} object showing the spatial distribution of adjusted p-values
on a signed -log10 scale. Spots with negative coefficients are colored in blue,
positive coefficients in red, and 0 in grey.
}
\description{
This function takes a results object returned from a continuous grid-based
celltype test. Each grid (window) is assumed to be named in the format
"Grid_x_y" (where x and y are the grid indices). For each grid, the function
extracts the adjusted p-values and regression coefficients for each variant (rows)
and cell type (columns), computes the signed -log10(p-value) (using the sign of the coefficient),
and then aggregates the data into a continuous heatmap across the spatial grid.
}
\examples{
\dontrun{
  # Assume 'results' is the object returned by your grid-based test function.
  p <- plot_spatial_logP(results)
  print(p)
}
}
