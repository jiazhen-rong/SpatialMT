% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Visualization.R
\name{plot_power_curves}
\alias{plot_power_curves}
\title{Plot power curves for multiple cell types across lineages}
\usage{
plot_power_curves(
  beta_list,
  effect_sizes,
  celltype_pattern = "BE|IM|SQ|FB|VC",
  desired_order = NULL,
  color_map = NULL,
  facet_ncol = NULL,
  title = "Power Analysis",
  save_pdf = FALSE,
  save_path = NULL,
  file_name = NULL,
  width = 8,
  height = 5,
  return_plot = T
)
}
\arguments{
\item{beta_list}{Named list. Each entry is a numeric vector of power values,
aligned with \code{effect_sizes}. Names must follow: "\if{html}{\out{<lineage>}}_\if{html}{\out{<celltype>}}".}

\item{effect_sizes}{Numeric vector of effect sizes (x-axis).}

\item{celltype_pattern}{Regex for cell type suffixes to include.
Default matches patterns like "BE|IM|SQ|FB|VC".}

\item{desired_order}{Optional character vector giving the facet order for lineages.
If NULL, ordering is whatever appears in the data.}

\item{facet_ncol}{Number of columns in facet_wrap. If NULL, ggplot decides.}

\item{title}{Plot title.}

\item{save_pdf}{Logical; if TRUE, save a PDF.}

\item{save_path}{Directory to save the PDF when save_pdf=TRUE.}

\item{file_name}{Output PDF filename when save_pdf=TRUE.}

\item{width, height}{PDF dimensions in inches.}

\item{return_plot}{Return the plot}

\item{celltype_colors}{Named character vector mapping celltype -> hex color.
If NULL, uses the default palette for BE/SQ/IM/FB/VC.}
}
\value{
\itemize{
\item plot: a ggplot object
}
}
\description{
This function extracts power vectors from a named list (beta_list) whose names
end with one of the specified cell type suffixes (e.g., "_BE", "_IM", ...),
converts them into a long data frame, and draws power curves vs. effect size
faceted by lineage.
}
\examples{
res <- plot_power_curves(beta_list, effect_sizes,
  desired_order = c("3054_G>C","3071_T>C","15777_G>C"),
  save_pdf = TRUE, save_path = save_path
)
}
