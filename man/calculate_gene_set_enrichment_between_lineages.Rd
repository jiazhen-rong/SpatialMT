% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DifferentialAnalysis.R
\name{calculate_gene_set_enrichment_between_lineages}
\alias{calculate_gene_set_enrichment_between_lineages}
\title{Calculate and Plot Gene Set Enrichment Between Two Lineages}
\usage{
calculate_gene_set_enrichment_between_lineages(
  seu,
  lineage1_cells,
  lineage2_cells,
  gene_programs,
  assay = "RNA",
  name_prefix = "Hallmark",
  ...
)
}
\arguments{
\item{seu}{A Seurat object containing gene expression data.}

\item{lineage1_cells}{A character vector of cell barcodes for lineage 1.}

\item{lineage2_cells}{A character vector of cell barcodes for lineage 2.}

\item{gene_programs}{A named list of gene sets (e.g., hallmark gene sets) where each element is a vector of gene symbols.}

\item{assay}{A character string specifying the assay to use for module scoring (default "RNA").}

\item{name_prefix}{A character string for the prefix used by \code{AddModuleScore} (default "Hallmark").}

\item{...}{Additional arguments passed to \code{AddModuleScore} (e.g., nbin).}
}
\value{
A list with two elements:
\item{avg_scores}{A matrix of average module scores (gene programs as rows, lineages as columns).}
\item{heatmap}{A pheatmap object displaying the enrichment heatmap.}
}
\description{
This function calculates gene set enrichment scores between two lineages in a Seurat object.
It takes two sets of cell barcodes (one for each lineage) and a named list of gene sets (e.g., cancer hallmark gene sets).
The function computes module scores using Seurat's \code{AddModuleScore} for each lineage, averages the module scores,
and then plots a heatmap of the average scores with gene sets as rows and lineages as columns.
}
\examples{
\dontrun{
  # Assuming 'seu' is your Seurat object and hallmark_list is your named list of gene sets:
  res <- calculate_gene_set_enrichment_between_lineages(
           seu, 
           lineage1_cells = l1_spots, 
           lineage2_cells = l2_spots, 
           gene_programs = hallmark_list, 
           assay = "RNA"
         )
  res$heatmap
}

}
