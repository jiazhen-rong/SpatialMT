% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HMRF.R
\name{log_posterior_prob}
\alias{log_posterior_prob}
\title{Compute Log Posterior Probability of the Model}
\usage{
log_posterior_prob(
  N_j,
  X_j,
  pi_j0 = 0.1,
  gamma = 0.5,
  Z_j,
  pi_1j = 0.5,
  neighbor_s_vaf,
  Wc,
  prior_energy = F,
  neighbor_num = 4,
  neighbor_s_list = NULL
)
}
\arguments{
\item{N_j}{Numeric vector of total read counts.}

\item{X_j}{Numeric vector of observed variant allele counts.}

\item{pi_j0}{Initial probability of background.}

\item{gamma}{Neighborhood effect scaling parameter.}

\item{Z_j}{Numeric vector of latent variable assignments (0 = background, 1 = carrier).}

\item{pi_1j}{Carrier probability parameter.}

\item{neighbor_s_vaf}{Numeric vector of neighborhood variant allele frequencies.}

\item{Wc}{Numeric vector of weighted cell-type proportions at each location.}

\item{prior_energy}{Logical; if \code{TRUE}, incorporates a spatial prior energy function.}

\item{neighbor_num}{Integer specifying the number of neighbors (needed if \code{prior_energy = TRUE}).}

\item{neighbor_s_list}{List where each element contains the indices of neighboring spots.}
}
\value{
The log posterior probability (a scalar value).
}
\description{
This function calculates the log posterior probability for the HMRF model,
incorporating binomial likelihood and optional spatial prior energy terms.
}
\details{
This function computes:
\deqn{LPP = \sum \log P(X_j | Z_j, \pi_{j0}, \gamma, \pi_{1j}) + \log P(Z_j | \text{neighbors})}
where:
\itemize{
\item \eqn{P(X_j | Z_j)} is modeled using the binomial likelihood.
\item \eqn{P(Z_j | \text{neighbors})} is a spatial prior energy function (if enabled).
}
}
\examples{
# Example usage
log_posterior_prob(N_j, X_j, pi_j0=0.1, gamma=0.5, Z_j, pi_1j=0.5,
                   neighbor_s_vaf, Wc, prior_energy=TRUE,
                   neighbor_num=4, neighbor_s_list=neighbor_s_list)
                   
}
